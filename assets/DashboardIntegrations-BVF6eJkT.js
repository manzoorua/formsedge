import{u as e,a as s,k as t,r as a,s as r,j as i,B as n,L as c,C as l,f as d,b as o,d as m,e as x}from"./main-BQOa5mM0.js";import{B as h}from"./badge-6grXs2Vt.js";import{A as f}from"./arrow-left-BoD24ioV.js";import{Z as j}from"./zap-Ewtv7hwb.js";import{S as u}from"./settings-CSYLqhyU.js";import{C as g}from"./circle-alert-C_kZuZo4.js";import{C as N}from"./circle-check-big-BImW7D2D.js";function p(){const{user:p}=e();s();const{toast:v}=t(),[w,b]=a.useState([]),[y,_]=a.useState([]),[C,S]=a.useState(!0);a.useEffect(()=>{p&&k()},[p]);const k=async()=>{try{const{data:e,error:s}=await r.from("forms").select("id, title, status, created_at").eq("owner_id",p?.id).order("created_at",{ascending:!1});if(s)throw s;const t=e?.map(e=>e.id)||[];let a=[];if(t.length>0){const{data:e,error:s}=await r.from("form_integrations").select("id, form_id, integration_type, name, status, is_active").in("form_id",t);if(s)throw s;a=e||[]}b(e||[]),_(a)}catch(e){v({title:"Error",description:"Failed to load forms and integrations",variant:"destructive"})}finally{S(!1)}},z=e=>{switch(e){case"connected":return i.jsx(N,{className:"h-4 w-4 text-green-500"});case"error":return i.jsx(g,{className:"h-4 w-4 text-red-500"});default:return i.jsx(g,{className:"h-4 w-4 text-yellow-500"})}},A=e=>{const s="connected"===e?"default":"error"===e?"destructive":"secondary";return i.jsxs(h,{variant:s,className:"flex items-center gap-1",children:[z(e),e]})};return C?i.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center",children:i.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})}):i.jsx("div",{className:"min-h-screen bg-background",children:i.jsxs("div",{className:"container mx-auto p-6",children:[i.jsx("div",{className:"flex items-center justify-between mb-6",children:i.jsxs("div",{className:"flex items-center space-x-4",children:[i.jsx(n,{variant:"ghost",size:"sm",asChild:!0,children:i.jsxs(c,{to:"/dashboard",children:[i.jsx(f,{className:"h-4 w-4 mr-2"}),"Back to Dashboard"]})}),i.jsxs("div",{children:[i.jsxs("h1",{className:"flex items-center gap-2 font-semibold text-zinc-600 text-2xl",children:[i.jsx(j,{className:"h-8 w-8"}),"Integrations"]}),i.jsx("p",{className:"text-muted-foreground",children:"Manage integrations for all your forms"})]})]})}),0===w.length?i.jsx(l,{children:i.jsxs(d,{className:"text-center py-12",children:[i.jsx(j,{className:"h-12 w-12 mx-auto text-muted-foreground mb-4"}),i.jsx("h3",{className:"text-lg font-semibold mb-2",children:"No forms found"}),i.jsx("p",{className:"text-muted-foreground mb-4",children:"Create your first form to start using integrations"}),i.jsx(n,{asChild:!0,children:i.jsx(c,{to:"/forms/new",children:"Create New Form"})})]})}):i.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:w.map(e=>{const s=(t=e.id,y.filter(e=>e.form_id===t));var t;const a=s.filter(e=>e.is_active);return i.jsxs(l,{className:"hover:shadow-lg transition-shadow",children:[i.jsx(o,{children:i.jsx("div",{className:"flex items-start justify-between",children:i.jsxs("div",{className:"flex-1 min-w-0",children:[i.jsx(m,{className:"text-lg truncate",children:e.title}),i.jsxs(x,{className:"flex items-center gap-2 mt-1",children:[i.jsx(h,{variant:"outline",className:"capitalize",children:e.status}),i.jsx("span",{className:"text-xs text-muted-foreground",children:new Date(e.created_at).toLocaleDateString()})]})]})})}),i.jsx(d,{children:i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{children:[i.jsx("h4",{className:"text-sm font-medium mb-2",children:"Integration Status"}),0===s.length?i.jsx("p",{className:"text-sm text-muted-foreground",children:"No integrations configured"}):i.jsxs("div",{className:"space-y-2",children:[i.jsxs("div",{className:"flex items-center justify-between text-sm",children:[i.jsx("span",{children:"Active integrations:"}),i.jsxs(h,{variant:"secondary",children:[a.length," of ",s.length]})]}),i.jsxs("div",{className:"grid grid-cols-1 gap-1",children:[s.slice(0,3).map(e=>i.jsxs("div",{className:"flex items-center justify-between text-xs",children:[i.jsx("span",{className:"truncate",children:e.name}),A(e.status)]},e.id)),s.length>3&&i.jsxs("div",{className:"text-xs text-muted-foreground",children:["+",s.length-3," more"]})]})]})]}),i.jsx("div",{className:"flex gap-2",children:i.jsx(n,{asChild:!0,className:"flex-1",variant:0===s.length?"default":"outline",children:i.jsxs(c,{to:`/forms/${e.id}/integrations`,children:[i.jsx(u,{className:"h-4 w-4 mr-2"}),0===s.length?"Add Integrations":"Manage"]})})})]})})]},e.id)})})]})})}export{p as default};
