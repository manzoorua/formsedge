var t=Object.defineProperty,s=(s,i,e)=>((s,i,e)=>i in s?t(s,i,{enumerable:!0,configurable:!0,writable:!0,value:e}):s[i]=e)(s,"symbol"!=typeof i?i+"":i,e);import{r as i}from"./main-BQOa5mM0.js";class e{constructor(t){s(this,"config"),s(this,"positionCache",new Map),s(this,"classCache",new Map),this.config=t}calculateFieldPositions(t){const s=t.map(t=>`${t.id}:${t.width||"full"}`).join(",")+`:${this.config.columns}`;if(this.positionCache.has(s))return this.positionCache.get(s);const i=[];let e=0,n=0;for(const o of t){const t=this.getFieldWidthInColumns(o.width);n+t>this.config.columns&&(e++,n=0),i.push({id:o.id,x:n,y:e,width:t,height:1}),n+=t,n>=this.config.columns&&(e++,n=0)}return this.positionCache.set(s,i),i}generateGridClasses(t){const s=`${t.width}:${this.config.columns}`;if(this.classCache.has(s))return this.classCache.get(s);const i=t.width>=this.config.columns?"col-span-full":`col-span-${t.width}`;return this.classCache.set(s,i),i}getContainerClasses(){const t=this.getGapClass();return`grid ${`grid-cols-${this.config.columns}`} ${t} ${this.config.responsive?"max-md:grid-cols-1":""}`.trim()}getFieldWidthInColumns(t){switch(t){case"quarter":return Math.max(1,Math.floor(this.config.columns/4));case"half":return Math.max(1,Math.floor(this.config.columns/2));default:return this.config.columns}}getGapClass(){switch(this.config.gridGap){case"sm":return"gap-2";case"md":return"gap-4";case"lg":return"gap-6";default:return"gap-3"}}updateConfig(t){this.config={...this.config,...t},this.positionCache.clear(),this.classCache.clear()}}const n=(t,s,e=!1)=>{const n=i.useCallback(t=>{const i=s[t.fieldId],{operator:e,value:n}=t;switch(e){case"equals":return String(i||"")===n;case"not_equals":return String(i||"")!==n;case"contains":return String(i||"").toLowerCase().includes(n.toLowerCase());case"greater_than":return Number(i||0)>Number(n);case"less_than":return Number(i||0)<Number(n);case"is_empty":return!i||""===String(i).trim();case"is_not_empty":return i&&""!==String(i).trim();default:return!1}},[s]),o=i.useCallback(t=>{if(!t.conditions.length)return!0;let s=n(t.conditions[0]);for(let i=1;i<t.conditions.length;i++){const e=t.conditions[i],o=n(e);s="OR"===t.conditions[i-1].logicOperator?s||o:s&&o}return"show"===t.action?s:!s},[n]),r=i.useMemo(()=>e?t:t.filter(t=>{if(!t.logic_conditions)return!0;try{const s=JSON.parse(t.logic_conditions);return o(s)}catch{return!0}}),[t,o,s,e]),c=i.useCallback(s=>{const i=t.find(t=>t.id===s);if(!i||!i.logic_conditions)return!0;try{const t=JSON.parse(i.logic_conditions);return o(t)}catch{return!0}},[t,o]);return{evaluateCondition:n,evaluateLogic:o,getVisibleFields:r,isFieldVisible:c}};export{e as L,n as u};
